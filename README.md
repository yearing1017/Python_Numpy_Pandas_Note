# Python_Numpy_Pandas_Note
â° è®°å½•é—å¿˜çš„Python3ã€numpyã€pandasç­‰çŸ¥è¯†ç‚¹

# ğŸ’¡ Python3 ç›¸å…³çŸ¥è¯†
## 1. Python3çš„æ ¼å¼åŒ–è¾“å‡º
- åœ¨Pythonä¸­ï¼Œé‡‡ç”¨çš„æ ¼å¼åŒ–æ–¹å¼å’ŒCè¯­è¨€æ˜¯ä¸€è‡´çš„ï¼Œç”¨%å®ç°ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š
```python
>>> 'Hello, %s' % 'world'
'Hello, world'
>>> 'Hi, %s, you have $%d.' % ('Michael', 1000000)
'Hi, Michael, you have $1000000.'
```
- `%`è¿ç®—ç¬¦å°±æ˜¯ç”¨æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ã€‚åœ¨å­—ç¬¦ä¸²å†…éƒ¨ï¼Œ`%s`è¡¨ç¤ºç”¨å­—ç¬¦ä¸²æ›¿æ¢ï¼Œ`%d`è¡¨ç¤ºç”¨æ•´æ•°æ›¿æ¢;
- æœ‰å‡ ä¸ª`%?`å ä½ç¬¦ï¼Œåé¢å°±è·Ÿå‡ ä¸ªå˜é‡æˆ–è€…å€¼ï¼Œé¡ºåºè¦å¯¹åº”å¥½ã€‚å¦‚æœåªæœ‰ä¸€ä¸ª`%?`ï¼Œæ‹¬å·å¯ä»¥çœç•¥ã€‚
- å¸¸è§çš„å ä½ç¬¦ï¼š
> | å ä½ç¬¦ |   æ›¿æ¢å†…å®¹   |
> | :----- | :----------: |
> | %d     |     æ•´æ•°     |
> | %f     |    æµ®ç‚¹æ•°    |
> | %s     |    å­—ç¬¦ä¸²    |
> | %x     | åå…­è¿›åˆ¶æ•´æ•° |
- æ ¼å¼åŒ–æ•´æ•°å’Œæµ®ç‚¹æ•°è¿˜å¯ä»¥æŒ‡å®šæ˜¯å¦è¡¥0å’Œæ•´æ•°ä¸å°æ•°çš„ä½æ•°:
```python
print('%2d-%02d' % (3, 1))
print('%.2f' % 3.1415926)

# è¾“å‡º,.è¡¨ç¤ºç©ºæ ¼
# .3-01
# 3ï¼Œ14
```
- ä¸Šé¢çš„%2dè¡¨ç¤ºè¾“å‡ºçš„å®½åº¦ä¸º2ï¼Œå³å¯¹é½ï¼Œæ‰€ä»¥åœ¨3å‰é¢åŠ ä¸€ä¸ªç©ºæ ¼ã€‚
- %02dè¡¨ç¤ºè¾“å‡ºçš„å®½åº¦ä¸º2ï¼Œ0è¡¨ç¤ºä¸å¤Ÿå®½åº¦ç”¨0è¡¥é½ã€‚
- å¦‚æœä¸å¤ªç¡®å®šåº”è¯¥ç”¨ä»€ä¹ˆï¼Œ%sæ°¸è¿œèµ·ä½œç”¨ï¼Œå®ƒä¼šæŠŠä»»ä½•æ•°æ®ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š
```python
>>> 'Age: %s. Gender: %s' % (25, True)
'Age: 25. Gender: True'
```
- å¦‚æœå­—ç¬¦ä¸²é‡Œé¢çš„%æ˜¯ä¸€ä¸ªæ™®é€šå­—ç¬¦ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦è½¬ä¹‰ï¼Œç”¨%%æ¥è¡¨ç¤ºä¸€ä¸ª%ï¼š
```python
>>> 'growth rate: %d %%' % 7
'growth rate: 7 %'
```
- å¦ä¸€ç§æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ–¹æ³•æ˜¯ä½¿ç”¨å­—ç¬¦ä¸²çš„format()æ–¹æ³•ï¼Œå®ƒä¼šç”¨ä¼ å…¥çš„å‚æ•°ä¾æ¬¡æ›¿æ¢å­—ç¬¦ä¸²å†…çš„å ä½ç¬¦{0}ã€{1}:
```python
>>> 'Hello, {0}, æˆç»©æå‡äº† {1:.1f}%'.format('å°æ˜', 17.125)
'Hello, å°æ˜, æˆç»©æå‡äº† 17.1%'
```
## 2. Python3çš„Withè¯­å¥

- æœ¬æ å°†æ€»ç»“`with`è¯­å¥çš„çŸ¥è¯†ç‚¹åŠåŸç†

### 2.1 withä¸æ–‡ä»¶ç›¸å…³

- åœ¨è¯»å†™æ–‡ä»¶çš„æ—¶å€™ï¼Œéœ€è¦åŠ ä¸Š**å¼‚å¸¸å¤„ç†**æ“ä½œï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

```python
try:
    fileReader = open('students.txt', 'r')

    for row in fileReader:
        print(row.strip())
except:
    print('Read file failed')
finally:
    fileReader.close()
```

- ä¸Šè¿°**å¼‚å¸¸å¤„ç†**æ“ä½œéå¸¸ç¹çï¼Œä¸Šè¿°å¯ä»¥ä½¿ç”¨withè¯­å¥æ¥ä»£æ›¿ã€‚
- `with`è¯­å¥é€‚ç”¨äºå¯¹èµ„æºè¿›è¡Œè®¿é—®çš„åœºåˆï¼Œ**ç¡®ä¿ä¸ç®¡ä½¿ç”¨è¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½ä¼šæ‰§è¡Œå¿…è¦çš„â€œæ¸…ç†â€æ“ä½œï¼Œé‡Šæ”¾èµ„æºï¼Œæ¯”å¦‚æ–‡ä»¶ä½¿ç”¨åè‡ªåŠ¨å…³é—­ã€çº¿ç¨‹ä¸­é”çš„è‡ªåŠ¨è·å–å’Œé‡Šæ”¾ç­‰**ã€‚
- æ¯”å¦‚ä¸Šé¢çš„ä»£ç ï¼Œé€šè¿‡ä½¿ç”¨`with`è¯­å¥æ”¹é€ ï¼Œå°±å˜æˆäº†ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š

```python
with open('students.txt', 'r') as fileReader:
    for row in fileReader:
        print(row.strip())
```

### 2.2 withè¯­å¥åŸç†

- è¦ææ¸…æ¥š`with`è¯­å¥çš„åŸç†ï¼Œå…ˆè¦çœ‹ä¸€ä¸‹è¿™å‡ ä¸ªæ¦‚å¿µï¼š
  - **ä¸Šä¸‹æ–‡ç®¡ç†åè®®ï¼ˆContext Management Protocolï¼‰**ï¼šåŒ…å«æ–¹æ³• `__enter__()`å’Œ`__exit__()`ï¼Œæ”¯æŒè¯¥åè®®çš„å¯¹è±¡è¦å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚
  - **ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼ˆContext Managerï¼‰**ï¼šæ”¯æŒä¸Šä¸‹æ–‡ç®¡ç†åè®®çš„å¯¹è±¡ï¼Œè¿™ç§å¯¹è±¡å®ç°äº†`__enter__()`å’Œ`__exit__()`æ–¹æ³•ã€‚ä¸Šä¸‹æ–‡ç®¡ç†å™¨å®šä¹‰æ‰§è¡Œ`with`è¯­å¥æ—¶è¦å»ºç«‹çš„è¿è¡Œæ—¶ä¸Šä¸‹æ–‡ï¼Œè´Ÿè´£æ‰§è¡Œ`with`è¯­å¥å—ä¸Šä¸‹æ–‡ä¸­çš„è¿›å…¥ä¸é€€å‡ºæ“ä½œã€‚é€šå¸¸ä½¿ç”¨`with`è¯­å¥è°ƒç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç›´æ¥è°ƒç”¨å…¶æ–¹æ³•æ¥ä½¿ç”¨ã€‚
- ä¸€æ®µåŸºæœ¬çš„withè¯­å¥å—å¦‚ä¸‹æ‰€ç¤ºï¼š

```python
with EXPR as VAR:
    BLOCK
```

- å…¶ä¸­**EXPRå¯ä»¥æ˜¯ä»»æ„è¡¨è¾¾å¼ï¼›as VARæ˜¯å¯é€‰çš„**ã€‚å…¶ä¸€èˆ¬çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š

  - **æ‰§è¡ŒEXPR**ï¼Œç”Ÿæˆä¸Šä¸‹æ–‡ç®¡ç†å™¨context_managerï¼›
  - **è·å–ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„`__exit()__`æ–¹æ³•**ï¼Œå¹¶ä¿å­˜èµ·æ¥ç”¨äºä¹‹åçš„è°ƒç”¨ï¼›
  - **è°ƒç”¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„`__enter__()`æ–¹æ³•**ï¼›å¦‚æœä½¿ç”¨äº†`as`å­å¥ï¼Œåˆ™å°†`__enter__()`æ–¹æ³•çš„è¿”å›å€¼èµ‹å€¼ç»™`as`å­å¥ä¸­çš„VARï¼›
  - **æ‰§è¡ŒBLOCKä¸­çš„è¡¨è¾¾å¼ï¼›**
  - ä¸ç®¡æ˜¯å¦æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯å¦å‘ç”Ÿäº†å¼‚å¸¸ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„`__exit__()`æ–¹æ³•ï¼Œ`__exit__()`æ–¹æ³•è´Ÿè´£æ‰§è¡Œâ€œæ¸…ç†â€å·¥ä½œï¼Œå¦‚é‡Šæ”¾èµ„æºç­‰ã€‚å¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œæˆ–è€…è¯­å¥ä½“ä¸­æ‰§è¡Œäº†è¯­å¥`break/continue/return`ï¼Œåˆ™ä»¥`None`ä½œä¸ºå‚æ•°è°ƒç”¨`__exit__(None, None, None)`ï¼›å¦‚æœæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œåˆ™ä½¿ç”¨`sys.exc_info`å¾—åˆ°çš„å¼‚å¸¸ä¿¡æ¯ä¸ºå‚æ•°è°ƒç”¨`__exit__(exc_type, exc_value, exc_traceback)`ï¼›
  - å‡ºç°å¼‚å¸¸æ—¶ï¼Œå¦‚æœ`__exit__(type, value, traceback)`è¿”å›Falseï¼Œåˆ™ä¼šé‡æ–°æŠ›å‡ºå¼‚å¸¸ï¼Œè®©`with`ä¹‹å¤–çš„è¯­å¥é€»è¾‘æ¥å¤„ç†å¼‚å¸¸ï¼Œè¿™ä¹Ÿæ˜¯é€šç”¨åšæ³•ï¼›å¦‚æœè¿”å›Trueï¼Œåˆ™å¿½ç•¥å¼‚å¸¸ï¼Œä¸å†å¯¹å¼‚å¸¸è¿›è¡Œå¤„ç†ã€‚

- **è‡ªå®šä¹‰å®ç°ä¸Šä¸‹æ–‡ç®¡ç†å™¨**

  å­¦å®Œäº†`with`è¯­å¥çš„å†…åœ¨åŸç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§è¿™ä¸ªåŸç†ï¼Œå®ç°æˆ‘ä»¬è‡ªå·±çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€‚è‡ªå®šä¹‰çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨è¦å®ç°ä¸Šä¸‹æ–‡ç®¡ç†åè®®æ‰€éœ€è¦çš„`__enter__()`å’Œ`__exit__()`ä¸¤ä¸ªæ–¹æ³•ï¼š

```python
class DBManager(object):
    def __init__(self):
        pass

    def __enter__(self):
        print('__enter__')
        return self

    def __exit__(self, exc_type, exc_val, exc_tb):
        print('__exit__')
        return True

def getInstance():
        return DBManager()

with getInstance() as dbManagerIns:
    print('with demo')
```

- ä»£ç è¿è¡Œç»“æœ

```python
__enter__
with demo
__exit__
```


# ğŸ’¡ Numpy ç›¸å…³çŸ¥è¯†

## 1.æœ‰å…³`np.argmin/argmax`åœ¨axisç»´åº¦ä¸Šçš„è®¤è¯†

- å…ˆçœ‹ä¸€æ®µæœ‰å…³argminçš„ä»£ç ï¼š
```python
import numpy as np
a = np.random.randint(24, size=[4,2,3,3])

print("aæœ¬èº«ä¸º:")
print(a)

a_argmin = np.argmin(a, axis=1)
print("argmin: axis=1")
print(a_argmin)

print("åŠ ä¸ŠNone:")
print(a_argmin[:,None,:,:])
```

- è¾“å‡ºç»“æœ
```python
aæœ¬èº«ä¸º:
[[[[ 3 14  4]
   [ 5 23 12]
   [ 0 22 20]]

  [[12 17 10]
   [ 1 15  1]
   [ 2 18  7]]]


 [[[19  6  5]
   [ 9 22  7]
   [ 4  8 11]]

  [[10  8 12]
   [21  7  4]
   [17 21  8]]]


 [[[ 5 22  0]
   [ 0 13 13]
   [14  5 13]]

  [[11 18  4]
   [ 0 10  7]
   [22  0  9]]]


 [[[15 21  2]
   [13 20 12]
   [14  3  7]]

  [[12 23 22]
   [11  1 21]
   [11 20 14]]]]
argmin: axis=1
[[[0 0 0]
  [1 1 1]
  [0 1 1]]

 [[1 0 0]
  [0 1 1]
  [0 0 1]]

 [[0 1 0]
  [0 1 1]
  [0 1 1]]

 [[1 0 0]
  [1 1 0]
  [1 0 0]]]
åŠ ä¸ŠNone:
[[[[0 0 0]
   [1 1 1]
   [0 1 1]]]


 [[[1 0 0]
   [0 1 1]
   [0 0 1]]]


 [[[0 1 0]
   [0 1 1]
   [0 1 1]]]


 [[[1 0 0]
   [1 1 0]
   [1 0 0]]]]
[Finished in 0.2s]
```
- aæœ¬èº«æ˜¯ä¸€ä¸ªnumpyçš„å¤šç»´æ•°ç»„ï¼Œshape:[4, 2, 3, 3]

- ç†è§£ï¼š4ä»£è¡¨ç¬¬0ç»´ï¼Œå…¶ä¸­è¾“å‡ºaçš„ç»“æœé¦–å°¾æœ‰4ä¸ª`[`æˆ–`]`å°±ä»£è¡¨è¯¥ç»´åº¦çš„æ•°å€¼

- ç†è§£ï¼š2ä»£è¡¨ç¬¬1ç»´ï¼Œå…¶ä¸­æ¯3ä¸ª`[`æˆ–`]`çš„ä¸­é—´å°±æœ‰ä¸¤å—æ•°æ®ï¼Œå¦‚ä¸‹ï¼š
```python
[[[19  6  5]
   [ 9 22  7]
   [ 4  8 11]]

  [[10  8 12]
   [21  7  4]
   [17 21  8]]]
```
- ç†è§£ï¼š3ä»£è¡¨ç¬¬2ç»´å’Œç¬¬3ç»´ï¼Œshapeçš„æœ€åä¸¤ä¸ªæ•°å­—è¡¨ç¤ºè¡Œåˆ—ã€‚å³æ¯ä¸¤ä¸ª`[`æˆ–`]`åŒ…èµ·æ¥çš„æ•°æ®ï¼š
```python
  [[10  8 12]
   [21  7  4]
   [17 21  8]]
```
- `np.argmin`è¡¨ç¤ºåœ¨æŸç»´åº¦ä¸Šæ¯”è¾ƒå¤§å°ï¼Œå–æœ€å°çš„ä¸‹æ ‡ç»„æˆï¼Œè¿”å›arrayï¼Œshapeä¸ºåŸndarrayå»æ‰axisç»´åº¦åçš„shape[4, 3, 3]

- åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œaxis=1è¡¨ç¤ºç¬¬1ç»´ï¼Œå³åœ¨æ¯ä¸¤ä¸ª3x3çš„çŸ©é˜µä¸Šä¸‹æ¯”è¾ƒå¤§å°

- `np.argmax`åŒç†ï¼Œå³å–è¾ƒå¤§çš„ä¸‹æ ‡è¿”å›ã€‚

- åœ¨shapeä¸­åŠ Noneï¼Œç›¸å½“äºåŠ äº†ä¸€ä¸ªæ–°çš„ç»´åº¦ï¼Œä½†æ˜¯æ²¡æœ‰æ–°çš„æ•°å€¼æ’å…¥ï¼Œä»…ä»…å¤šäº†è¡¨ç¤ºç»´åº¦çš„`[`å’Œ`]`

## 2. Numpyå¯¹ndarryçš„ä¸€äº›æ“ä½œ

- çœ‹ä»£ç ï¼š
```python
# ä»¿ç…§åˆ—è¡¨æ’åº
A = np.arange(14,2,-1).reshape((3,4)) # -1è¡¨ç¤ºåå‘é€’å‡ä¸€ä¸ªæ­¥é•¿
print(A)
# è¾“å‡º
[[14 13 12 11]
 [10  9  8  7]
 [ 6  5  4  3]]
 
print(np.sort(A))
# è¾“å‡º
[[11 12 13 14]
 [ 7  8  9 10]
 [ 3  4  5  6]]
 
# çŸ©é˜µè½¬ç½®ï¼Œæˆ–print(A.T)
print(np.transpose(A))
# è¾“å‡º
[[14 10  6]
 [13  9  5]
 [12  8  4]
 [11  7  3]]
 
# clipå‡½æ•°
print(np.clip(A,5,9))
# è¾“å‡º
[[9 9 9 9]
 [9 9 8 7]
 [6 5 5 5]]
'''
clip(Array,Array_min,Array_max)

å°†Array_min<X<Array_max Xè¡¨ç¤ºçŸ©é˜µAä¸­çš„æ•°ï¼Œå¦‚æœæ»¡è¶³ä¸Šè¿°å…³ç³»ï¼Œåˆ™åŸæ•°ä¸å˜ã€‚

å¦åˆ™ï¼Œå¦‚æœX<Array_minï¼Œåˆ™å°†çŸ©é˜µä¸­Xå˜ä¸ºArray_min;

å¦‚æœX>Array_maxï¼Œåˆ™å°†çŸ©é˜µä¸­Xå˜ä¸ºArray_max.
'''
```

## 3. Numpyçš„ç´¢å¼•å’Œåˆ‡ç‰‡
- çœ‹ä»£ç ï¼š
```python
import numpy as np
A = np.arange(3,15)
B = A.reshape(3,4)
print(B)
# B
[[ 3  4  5  6]
 [ 7  8  9 10]
 [11 12 13 14]]
 
print(B[2])
# B[2]
[11 12 13 14]

print(B[0][2]) #B[0][2]å’ŒB[0,2]ç­‰ä»·ï¼Œæ‰“å°éƒ½æ˜¯5

# liståˆ‡ç‰‡æ“ä½œ
print(B[1,1:3]) # [8 9] 1:3è¡¨ç¤º1-2ä¸åŒ…å«3


for row in B:
    print(row)
# è¾“å‡º
[3 4 5 6]
[ 7  8  9 10]
[11 12 13 14]

# å¦‚æœè¦æ‰“å°åˆ—ï¼Œåˆ™è¿›è¡Œè½¬ç½®å³å¯
for column in B.T:
    print(column)
# è¾“å‡º
[ 3  7 11]
[ 4  8 12]
[ 5  9 13]
[ 6 10 14]

# å¤šç»´è½¬ä¸€ç»´
A = np.arange(3,15).reshape((3,4))
# print(A)
print(A.flatten())
# flatæ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæœ¬èº«æ˜¯ä¸€ä¸ªobjectå±æ€§
[ 3  4  5  6  7  8  9 10 11 12 13 14]
```
- ä¸€äº›å¸¸è§çš„åˆ‡ç‰‡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ¯ç§é¢œè‰²å¯¹åº”ç»“æœï¼š
![numpy](https://github.com/yearing1017/Python_Numpy_Pandas_Note/blob/master/images/qiepian.jpg)



# ğŸ’¡ Pandas ç›¸å…³çŸ¥è¯†
